<div class="animated fadeInDown card bg-white text-dark">
    <div class="card-header">Queja de la factura {{claim.facture.id}}</div>
    <div class="card-body">
        
        <form #claimForm="ngForm">
            <button type="button" style="margin-bottom: 10%;" name="details" [routerLink]="['/detailsFacture', claim.facture.id]"  class="btn btn-sm" *ngIf="authService.hasRole('ROLE_REPORTER')">Ver factura</button>
            
            <div class="form-group row" *ngIf="claim?.answer &&  this.authService.hasRole('ROLE_CLIENT')">
                <label for="status" class="col-form-label">Estado:</label>
                <div class="col-sm-4">
                    <h3 style="width: 300px;">{{claim.status}}</h3>
                </div>
            </div>
            
        </h2>
            <br>
            <mat-label>Respuesta recibida</mat-label>

            <div class="form-group row" *ngIf="claim?.answer && this.authService.hasRole('ROLE_CLIENT')">
                <div class="col-sm-4">
                    <textarea type="text" class="form-control" [(ngModel)]="claim.answer" name="answer" style="width: 300px;" disabled></textarea>
        <div class="form-group " *ngIf="this.authService.hasRole('ROLE_REPORTER') && claim.reporter !=null && (claim.reporter.username === this.authService.usuario.username)">
                    {{statu}}
            </div>

            <div class="form-group row" *ngIf="this.authService.hasRole('ROLE_REPORTER') && claim.reporter !=null && (claim.reporter.username === this.authService.usuario.username)">
                <label for="status" class="col-form-label">Estado:</label>
                <select value="{{claim.status}"  name="status" class="form-control" style="width: 200px;margin-left: 4%;" [(ngModel)]="claim.status">
                    <option  *ngFor="let statu of status" >
                    </option>
                </select>
                </div>
        </mat-form-field>
        <hr *ngIf="claim?.answer">
        <mat-form-field style="width: 100%;" appearance="legacy">
            <mat-label>Título</mat-label>
            <input matInput class="form-control" [(ngModel)]="claim.title" name="title" required #title="ngModel" style="color: black" disabled >
            <mat-error *ngIf="title.invalid && (title.dirty || title.touched) && title.errors.required">
                Este campo es obligatorio
              </mat-error>
              
        </mat-form-field>

        <mat-form-field style="width: 100%;">
            <mat-label>Descripción</mat-label>
            <textarea matInput class="form-control" [(ngModel)]="claim.description" name="description" required #description="ngModel" style="color: black" disabled></textarea>
            <mat-error *ngIf="description.invalid && (description.dirty || description.touched) && description.errors.required">
                Este campo es obligatorio
              </mat-error>
          </mat-form-field>

        

        <div *ngIf="this.authService.hasRole('ROLE_REPORTER') && claim.reporter !=null && (claim.reporter.username === this.authService.usuario.username)">
                <button mat-raised-button style="float: right;" (click)="update()"  [disabled]="!claimForm.form.valid" >Resolver queja</button>

        </div>

    </form>
</div>


